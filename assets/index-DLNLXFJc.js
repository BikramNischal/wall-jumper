var U=Object.defineProperty;var Z=(i,t,s)=>t in i?U(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var e=(i,t,s)=>Z(i,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const h of n)if(h.type==="childList")for(const a of h.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const h={};return n.integrity&&(h.integrity=n.integrity),n.referrerPolicy&&(h.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?h.credentials="include":n.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(n){if(n.ep)return;n.ep=!0;const h=s(n);fetch(n.href,h)}})();const $=document.querySelector(".game-window"),w=document.querySelector(".canvas"),c=w.getContext("2d"),S=$.getBoundingClientRect();w.height=S.height;w.width=S.width;const f=2,K=f+1,d={width:w.width,height:w.height},g={x:0,y:-64,width:64,height:d.height+100,offSet:5},m={width:10,heightSmall:72,heightBig:160,gapX:150,gapY:150},B=8,E=-6,Q={width:48,height:48,offset:15},I={width:32,height:32},F={width:24,height:24},H=100,ii=0+g.width,ti=d.height/2;class y{constructor(t){e(this,"sound");this.sound=new Audio,this.sound.src=t}play(){this.sound.play()}stop(){this.sound.pause()}}class T{constructor(t,s){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"pointValue");e(this,"img");e(this,"loaded");e(this,"collisionSound");this.x=t,this.y=s,this.dx=10,this.dy=10,this.w=64,this.h=64,this.pointValue=1,this.loaded=!1,this.img=new Image,this.collisionSound=new y("./sounds/obstaclecollision.m4a")}moveInY(t){this.y+=t}}class si extends T{constructor(s,o,n,h,a,u){super(s,o);e(this,"startPos");e(this,"endPos");e(this,"direction");this.startPos=a,this.endPos=u,this.direction=n,this.img.src=h,this.img.onload=()=>{this.loaded=!0,this.draw()}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.y)}oscillate(){this.direction==="horizontal"?(this.x>=this.endPos?this.dx=-Math.abs(this.dx):this.x<=this.startPos&&(this.dx=Math.abs(this.dx)),this.x+=this.dx):(this.y>=this.endPos?this.dy=-Math.abs(this.dy):this.y<=this.startPos&&(this.dy=Math.abs(this.dy)),this.y+=this.dy)}}class ei extends si{constructor(s,o,n,h,a,u){super(s,o,n,h,a,u);e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");this.spriteHeight=32,this.spriteWidth=32,this.currentFrame=0,this.totalFrame=8,this.h=I.height,this.w=I.width,this.dx=1,this.pointValue=2}draw(){this.loaded&&c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),this.currentFrame=(this.currentFrame+1)%this.totalFrame}}function p(i){return Math.floor(Math.random()*i)}function J(i,t){return Math.floor(Math.random()*(t-i)+i)}function ni(){const i=p(100);return i<10&&i%2===0}function v(){const i=p(100);return i<100/2&&i%2===0}function C(){return p(100)<50}class b{constructor(t,s,o,n){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"type");e(this,"loaded");e(this,"spike");e(this,"effect");e(this,"effectUsed");e(this,"pointValue");e(this,"sound");this.x=t,this.y=s,this.dx=0,this.dy=f,this.w=m.width,this.h=m.heightSmall,this.pointValue=1,this.type=o,this.loaded=!1,this.spike=this.placeSpike(),this.img=new Image,this.img.src=n,this.img.onload=()=>{this.loaded=!0,this.draw()},this.effect=null,this.effectUsed=!1,this.sound=null}updateImage(t){this.img.src=t}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}setMainWall(){this.w=g.width,this.h=g.height}moveInY(t){this.y+=t,this.spike&&this.spike.moveInY(t)}moveInX(){this.x+=this.dx}placeSpike(){if(v()&&this.type<2){const s=ui();s.face==="left"?s.x=this.x-s.w:s.x=this.x+this.w;let o=this.y+p(this.h-s.h);return s.y=o,s}else return null}}function A(){switch(p(2)){case 0:return m.heightSmall;case 1:return m.heightBig;default:return m.heightSmall}}function oi(){return ni()?3:v()?2:1}function O(){const i=p(d.width/2),s=d.width*2/5+i+m.gapX;return s>d.width*.075?s-d.width/2:s}function ri(){const i=.5*d.width,t=3/4*d.width;return J(i,t)}class q{constructor(t,s,o,n,h,a){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");e(this,"pointValue");e(this,"collisionSound");this.x=t,this.y=s,this.dx=-2,this.dy=f,this.w=F.width,this.h=F.height,this.pointValue=3,this.loaded=!1,this.img=new Image,this.img.src=o,this.img.onload=()=>{this.loaded=!0},this.spriteHeight=h,this.spriteWidth=n,this.totalFrame=a,this.currentFrame=0,this.w=64,this.h=64,this.collisionSound=new y("./sounds/obstaclecollision.m4a")}draw(t){this.loaded&&c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),t%10===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame)}moveInY(t){this.y+=t}}class hi extends q{constructor(t,s,o,n,h,a){super(t,s,o,n,h,a)}changeDirection(){this.x<=g.x+g.width||this.x+this.w>=d.width?(this.dx*=-1,this.dx<0?this.img.src="./images/demon-left.png":this.img.src="./images/demon-right.png"):this.dx=this.dx}moveInX(){this.changeDirection(),this.x+=this.dx}}class R extends T{constructor(s,o,n){super(s,o);e(this,"face");this.face=n,this.w=24,this.h=24,this.selectSpike()}selectSpike(){const s=p(100);this.face==="right"?s%3===0?this.img.src="./images/spike1-right.png":s%3===1?this.img.src="./images/spike2-right.png":this.img.src="./images/trap-right.png":s%3===0?this.img.src="./images/spike1-left.png":s%3===1?this.img.src="./images/spike2-left.png":this.img.src="./images/trap-left.png",this.img.onload=()=>{this.loaded=!0}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}moveInY(s){this.y+=s}}class di extends q{constructor(t,s,o,n,h,a){super(t,s,o,n,h,a)}draw(t){this.loaded&&c.drawImage(this.img,0,this.currentFrame*this.spriteHeight,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),t%10===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame)}moveInY(t){this.y+=t+1}}function L(i){let t;const s=ri(),o=A(),n=i?i.y-o-m.gapY:d.height-o-m.gapY;let h=oi();return h===1?t=new b(s,n,1,"./images/normal-wall.png"):h===2?t=new b(s,n,2,"./images/rubber-wall.png"):t=new b(s,n,3,"./images/ice-wall.png"),t.h=o,t}function ai(i){const t=[];for(let s=0;s<i;++s){let o=t.length?L(t[t.length-1]):L(null);t.push(o)}return t}function ci(){const i=O(),t=i+H-I.width>d.width-I.width?d.width-I.width:i+H,s=J(i,t);return new ei(s,0,"horizontal","./images/Suriken.png",i,t)}function z(i){const t=d.height/2,s=[];for(let o=0;o<i;++o){const n=ci(),h=d.height-n.h-t*(o+1);n.y=h,n.dx=C()?1:-1,n.dy=C()?1:-1,s.push(n)}return s}function li(i){return new R(0,0,i)}function ui(){const i=C()?"right":"left";return li(i)}function V(i){const t=Q.height*10,s=Math.floor(i%5),o=s<3?s:3,n=[];for(let h=0;h<p(o);++h){let a=0;n.length&&(a=n[n.length-1].y-t);const u=new R(g.width,a,"right");n.push(u)}return n}function gi(){const i=O();return new hi(i,0,"./images/demon-left.png",79,69,4)}function mi(){return[]}function pi(){let i="";switch(p(4)){case 0:i="./images/spider-black.png";break;case 1:i="./images/spider-purple.png";break;case 2:i="./images/spider-green.png";break;case 3:i="./images/spider-brown.png";break}const s=g.x+g.width-g.offSet,o=new di(s,0,i,49,80.3,3);return o.dy=K,o}function fi(){return[]}function yi(i){c.fillStyle="white",c.font="50px Offside",c.fillText(`${i}`,d.width/2,50)}function wi(i){if(i.walls.length){const t=i.walls[i.walls.length-1];if(t.y>d.height&&i.walls.shift(),i.walls[i.walls.length-1].y>m.gapY){const s=A(),o=i.walls[i.walls.length-1].y-m.gapY-s,n=L(t);n.h=s,n.y=o,i.walls.push(n)}}else i.walls.push(L(null))}function ki(i){if(i.blades.forEach(t=>{t.y>d.height&&i.blades.shift()}),i.blades.length===0){const t=z(p(3));t.reverse(),t.forEach(s=>{s.y*=-1}),i.blades.push(...t)}}function xi(i){if(i.mainWallSpikes.forEach(t=>{t.y>d.height&&i.mainWallSpikes.shift()}),i.mainWallSpikes.length===0){const t=V(i.score);i.mainWallSpikes.push(...t)}}function Ii(i,t){i.length&&(i[0].y>d.height&&i.shift(),i.forEach(s=>{s.moveInY(t),s.moveInX()}))}function bi(i,t){i.length&&(i[0].y>d.height&&i.shift(),i.forEach(s=>{s.moveInY(t)}))}function Wi(){let i;const t=localStorage.getItem("walljumper");return t?i=JSON.parse(t):i=[],i}function vi(i){localStorage.setItem("walljumper",JSON.stringify(i))}function Li(i,t){let s=!1;t.forEach(o=>{o.name===i.name&&(o.value<i.value&&(o.value=i.value),s=!0)}),s||t.push(i)}const Mi=document.querySelector(".start-menu"),X=document.querySelector(".restart-menu"),G=document.querySelector(".pause-window"),Bi=document.querySelector(".score"),Y=document.querySelector(".leaderboard");function Ei(i){Y.innerHTML="";for(const t of i){const s=document.createElement("p"),o=document.createElement("span"),n=document.createElement("span");s.classList.add("leaderboard-row"),o.classList.add("leaderboard-entry"),n.classList.add("leaderboard-entry"),o.innerHTML=t.name,n.innerHTML=t.value.toString(),s.appendChild(o),s.appendChild(n),Y.appendChild(s)}}function D(i){Mi.style.display="none",X.style.display="none",w.style.display="block";const t=setTimeout(()=>{i.clickState=!0,clearTimeout(t)},10)}function k(i,t){t.player.jumpCount=0;const s=Wi(),o={name:t.userName,value:t.score};Li(o,s),s.sort((h,a)=>a.value-h.value),vi(s),Ei(s),X.style.display="flex",Bi.innerHTML=`${t.userName} : ${t.score}`,w.style.display="none";const n=setTimeout(()=>{i.clickState=!0,clearTimeout(n)},10)}function Ci(){G.style.display="flex"}function ji(){G.style.display="none"}class N{constructor(t,s,o){e(this,"x");e(this,"y");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"duration");this.x=t,this.y=s,this.w=32,this.h=48,this.dy=f,this.loaded=!1,this.img=new Image,this.img.src=o,this.duration=0,this.img.onload=()=>{this.loaded=!0,this.draw()}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}setDuration(t){this.duration=t}getDuration(){return this.duration}moveInY(){this.y+=this.dy}}function Fi(i,t){const s=i.x+i.w/2-(t.x+t.w/2),o=i.y+i.h/2-(t.y+t.h/2),n=(i.w+t.w)/2,h=(i.h+t.h)/2,a=n*o,u=h*s;if(Math.abs(s)<=n&&Math.abs(o)<=h)if(a>u){if(a>-u)i.y=t.y+t.h-i.h/2,i.x<t.x?i.x=t.x-i.w:i.x=t.x+t.w;else if(i.x=t.x-i.w,i.xDirection=-1,i.img.src="./images/grab-right.png",t.type===3&&!t.effectUsed){const M=new N(i.x,i.y,"./images/icecloud-right.png");t.effect=M}}else if(a>-u){if(i.x=t.x+t.w,i.xDirection=1,i.img.src="./images/grab-left.png",t.type===3&&!t.effectUsed){const M=new N(i.x,i.y,"./images/icecloud-left.png");t.effect=M}}else i.y=t.y,i.x<t.x?i.x=t.x-i.w:i.x=t.x+t.w}function Hi(i){i.xDirection*=-1,i.dx=i.xDirection*B,i.dy=i.jumpHeight,i.isJumping=!0}class Yi{constructor(t,s,o){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"horizontalDelay");e(this,"gravity");e(this,"isJumping");e(this,"jumpHeight");e(this,"jumpCount");e(this,"xDirection");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");e(this,"jumpSound");e(this,"airJumpSound");e(this,"fallSound");this.x=t,this.y=s,this.w=32,this.h=32,this.xDirection=1,this.horizontalDelay=.05,this.gravity=.1,this.jumpHeight=E,this.dx=B,this.dy=this.jumpHeight,this.isJumping=!1,this.jumpCount=2,this.loaded=!1,this.img=new Image,this.img.src=o,this.img.onload=()=>{this.loaded=!0,this.draw()},this.spriteHeight=67,this.spriteWidth=64,this.currentFrame=0,this.totalFrame=8,this.jumpSound=new y("./sounds/jumpsound.m4a"),this.airJumpSound=new y("./sounds/airjumpsound.m4a"),this.fallSound=new y("./sounds/fallsound.m4a")}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}drawJumpSprite(t){this.loaded&&(c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,48,48),t%2===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame))}resetJump(){this.jumpCount===1&&(this.xDirection*=-1),this.dx=B*this.xDirection,this.dy=this.jumpHeight}changeJumpingImage(){this.dx>0&&this.jumpCount===1?this.img.src="./images/jump-right.png":this.dx<0&&this.jumpCount===1?this.img.src="./images/jump-left.png":this.dx>0&&this.jumpCount===0?this.img.src="./images/mid-jump-right-sprite.png":this.img.src="./images/mid-jump-left-sprite.png"}jump(){this.changeJumpingImage(),this.dy+=this.gravity,this.dx=this.dx>0?this.dx-this.horizontalDelay:this.dx+this.horizontalDelay,this.x+=this.dx,this.dy>0?this.y+=this.dy:this.y>0?this.y+=this.dy:this.dy-=this.dy,this.dy>-E&&(this.dy=-this.jumpHeight),this.x+this.w>=d.width&&this.dx>0&&(this.jumpCount=1,this.dx=-this.dx,this.dy=this.jumpHeight/2)}isColliding(t){return t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h/2&&t.y+t.h>this.y}collisionWall(t){this.isColliding(t)&&(this.jumpCount=2,this.isJumping=!1,t.type===2?(t.sound=new y("./sounds/rubberbounce1.mp3"),t.sound.play(),--this.jumpCount,Hi(this)):t.type===3&&(t.sound=new y("./sounds/freezingSound.m4a"),t.sound.play())),Fi(this,t)}moveInY(t){this.y+=t}}class j{constructor(t,s,o,n,h,a,u){e(this,"x");e(this,"y");e(this,"dy");e(this,"skyLoaded");e(this,"skyImg");e(this,"rockBackgroundLoaded");e(this,"rockBackgroundImg");e(this,"rockLoaded");e(this,"rockImg");e(this,"cloudBackgroundLoaded");e(this,"cloudBackgroundImg");e(this,"cloudLoaded");e(this,"cloudImg");this.x=t,this.y=s,this.dy=f,this.skyImg=new Image,this.skyImg.src=o,this.skyLoaded=!1,this.skyImg.onload=()=>{this.skyLoaded=!0,this.draw()},this.rockBackgroundImg=new Image,this.rockBackgroundImg.src=n,this.rockBackgroundLoaded=!1,this.rockBackgroundImg.onload=()=>{this.rockBackgroundLoaded=!0,this.draw()},this.rockImg=new Image,this.rockImg.src=h,this.rockLoaded=!1,this.rockImg.onload=()=>{this.rockLoaded=!0,this.draw()},this.cloudBackgroundImg=new Image,this.cloudBackgroundImg.src=a,this.cloudBackgroundLoaded=!1,this.cloudBackgroundImg.onload=()=>{this.cloudBackgroundLoaded=!0,this.draw()},this.cloudImg=new Image,this.cloudImg.src=u,this.cloudLoaded=!1,this.cloudImg.onload=()=>{this.cloudLoaded=!0,this.draw()}}draw(){this.skyLoaded&&this.rockBackgroundLoaded&&this.cloudBackgroundLoaded&&this.cloudLoaded&&(c.drawImage(this.skyImg,this.x,this.y),c.drawImage(this.rockBackgroundImg,this.x,this.y),c.drawImage(this.rockImg,this.x,this.y),c.drawImage(this.cloudBackgroundImg,this.x,this.y),c.drawImage(this.cloudImg,this.x,this.y))}moveInY(){this.y+=this.dy}}const Di=new j(-700,0,"./images/background/sky1.png","./images/background/rockBackground1.png","./images/background/rock1.png","./images/background/cloudbackground1.png","./images/background/cloud1.png"),Ni=new j(-700,0,"./images/background/sky2.png","./images/background/rock2.png","./images/background/ground1.png","./images/background/ground2.png","./images/background/cloud2.png"),Pi=new j(-700,0,"./images/background/sky3.png","./images/background/rockbackground3.png","./images/background/rock3.png","./images/background/pines.png","./images/background/cloud3.png"),Si=document.querySelector(".btn--start"),Ti=document.querySelector(".btn--restart"),P=document.querySelector(".user-name");let x;P.onchange=()=>{x=P.value};const r={pause:!1,clickState:!1,restart:!1,gameMovement:f},_=()=>({blades:z(2),mainWall:new b(g.x,g.y,0,"./images/main-platform.png"),walls:ai(3),player:new Yi(ii,ti,"./images/grab-left.png"),gameSpeed:0,demons:mi(),spiders:fi(),mainWallSpikes:V(0),score:0,userName:"Unknown",backgrounds:[Di,Pi,Ni]});let l=_();function W(i){c.clearRect(0,0,d.width,d.height),i.score<=20?i.backgrounds[0].draw():i.score<=40?i.backgrounds[1].draw():i.backgrounds[2].draw(),yi(i.score),++i.gameSpeed,r.gameMovement=f+i.score/10*.5,i.player.jumpHeight=E+i.score/10*.5,i.mainWall.draw(),i.gameSpeed%700===0&&v()&&i.demons.push(gi()),Ii(i.demons,r.gameMovement);for(let t=0;t<i.demons.length&&!r.restart;++t){const s=i.demons[t];if(s.draw(i.gameSpeed),i.player.isColliding(s)){r.restart=!0,s.collisionSound.play(),k(r,i);return}}i.gameSpeed%300===0&&v()&&i.spiders.push(pi()),bi(i.spiders,r.gameMovement);for(let t=0;t<i.spiders.length&&!r.restart;++t){const s=i.spiders[t];if(s.draw(i.gameSpeed),i.player.isColliding(s)){r.restart=!0,s.collisionSound.play(),k(r,i);return}}for(let t=0;t<i.mainWallSpikes.length&&!r.restart;++t){const s=i.mainWallSpikes[t];if(s.moveInY(r.gameMovement),s.draw(),i.player.isColliding(s)){r.restart=!0,s.collisionSound.play(),k(r,i);return}}if(i.player.moveInY(r.gameMovement),i.player.y>d.height){r.restart=!0,i.player.fallSound.play(),k(r,i);return}i.player.collisionWall(i.mainWall),i.player.jumpCount?i.player.draw():i.player.drawJumpSprite(i.gameSpeed),i.player.isJumping&&i.player.jump();for(let t=0;t<i.walls.length&&!r.restart;++t){const s=i.walls[t];if(s.moveInY(r.gameMovement),s.draw(),s.effect&&!s.effectUsed){s.effect.draw(),r.clickState=!1;const o=setTimeout(()=>{s.effect=null,s.effectUsed=!0,r.clickState=!0,clearTimeout(o)},1e3)}if(s.spike&&(s.spike.draw(),i.player.isColliding(s.spike))){r.restart=!0,s.spike.collisionSound.play(),k(r,i);return}i.player.collisionWall(s)}for(let t=0;t<i.blades.length;++t){const s=i.blades[t];if(s.moveInY(r.gameMovement),s.draw(),s.oscillate(),i.player.isColliding(s)){r.restart=!0,s.collisionSound.play(),k(r,i);return}}ki(i),wi(i),xi(i),i.gameSpeed%100===0&&++i.score,!r.pause&&requestAnimationFrame(()=>W(i))}function Ji(){Si.onclick=()=>{x&&(l.userName=x),r.clickState=!1,D(r),l.mainWall.setMainWall(),W(l)},Ti.onclick=()=>{r.clickState=!1,r.restart=!1,r.gameMovement=f,D(r),l=_(),x&&(l.userName=x),l.mainWall.setMainWall(),W(l)},document.addEventListener("click",()=>{!r.pause&&r.clickState&&(c.clearRect(0,0,d.width,d.height),l.player.jumpCount>0&&(l.player.isJumping=!0,l.player.jumpCount===2?l.player.jumpSound.play():l.player.airJumpSound.play(),l.player.resetJump(),--l.player.jumpCount))}),document.addEventListener("keydown",i=>{i.key===" "&&r.pause?(r.pause=!1,ji(),W(l)):i.key===" "&&!r.restart&&(r.pause=!0,Ci())})}Ji();
