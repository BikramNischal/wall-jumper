var Z=Object.defineProperty;var $=(i,t,s)=>t in i?Z(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var e=(i,t,s)=>$(i,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();const K=document.querySelector(".game-window"),w=document.querySelector(".canvas"),c=w.getContext("2d"),H=K.getBoundingClientRect();w.height=H.height;w.width=H.width;const f=2,Q=f+1,d={width:w.width,height:w.height},u={x:0,y:-64,width:64,height:d.height+100,offSet:5},g={width:10,heightSmall:72,heightBig:160,gapX:150,gapY:150},C=8,x=-6,ii={width:24,height:24},b={width:32,height:32},Y={width:24,height:24},D=100,ti=0+u.width,si=d.height/2;class y{constructor(t){e(this,"sound");this.sound=new Audio,this.sound.src=t}play(){this.sound.play()}stop(){this.sound.pause()}}class J{constructor(t,s){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"pointValue");e(this,"img");e(this,"loaded");e(this,"collisionSound");this.x=t,this.y=s,this.dx=10,this.dy=10,this.w=64,this.h=64,this.pointValue=1,this.loaded=!1,this.img=new Image,this.collisionSound=new y("./sounds/obstaclecollision.m4a")}moveInY(t){this.y+=t}}class ei extends J{constructor(s,n,o,r,a,m){super(s,n);e(this,"startPos");e(this,"endPos");e(this,"direction");this.startPos=a,this.endPos=m,this.direction=o,this.img.src=r,this.img.onload=()=>{this.loaded=!0,this.draw()}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.y)}oscillate(){this.direction==="horizontal"?(this.x>=this.endPos?this.dx=-Math.abs(this.dx):this.x<=this.startPos&&(this.dx=Math.abs(this.dx)),this.x+=this.dx):(this.y>=this.endPos?this.dy=-Math.abs(this.dy):this.y<=this.startPos&&(this.dy=Math.abs(this.dy)),this.y+=this.dy)}}class ni extends ei{constructor(s,n,o,r,a,m){super(s,n,o,r,a,m);e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");this.spriteHeight=166,this.spriteWidth=164.5,this.currentFrame=0,this.totalFrame=5,this.h=b.height,this.w=b.width,this.dx=1,this.pointValue=2}draw(){this.loaded&&c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),this.currentFrame=(this.currentFrame+1)%this.totalFrame}}function p(i){return Math.floor(Math.random()*i)}function A(i,t){return Math.floor(Math.random()*(t-i)+i)}function oi(){const i=p(100);return i<20&&i%2===0}function L(){const i=p(100);return i<100/2&&i%2===0}function B(){return p(100)<50}class W{constructor(t,s,n,o){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"type");e(this,"loaded");e(this,"spike");e(this,"effect");e(this,"effectUsed");e(this,"pointValue");e(this,"sound");this.x=t,this.y=s,this.dx=0,this.dy=f,this.w=g.width,this.h=g.heightSmall,this.pointValue=1,this.type=n,this.loaded=!1,this.spike=this.placeSpike(),this.img=new Image,this.img.src=o,this.img.onload=()=>{this.loaded=!0,this.draw()},this.effect=null,this.effectUsed=!1,this.sound=null}updateImage(t){this.img.src=t}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}setMainWall(){this.w=u.width,this.h=u.height}moveInY(t){this.y+=t,this.spike&&this.spike.moveInY(t)}moveInX(){this.x+=this.dx}placeSpike(){if(L()&&this.type<2){const s=gi();s.face==="left"?s.x=this.x-s.w:s.x=this.x+this.w;let n=this.y+p(this.h-s.h);return s.y=n,s}else return null}}function O(){switch(p(2)){case 0:return g.heightSmall;case 1:return g.heightBig;default:return g.heightSmall}}function ri(){return oi()?3:L()?2:1}function q(){const i=p(d.width/2),s=d.width*2/5+i+g.gapX;return s>d.width*.075?s-d.width/2:s}function hi(){const i=.5*d.width,t=3/4*d.width;return A(i,t)}class R{constructor(t,s,n,o,r,a){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");e(this,"pointValue");e(this,"collisionSound");this.x=t,this.y=s,this.dx=-2,this.dy=f,this.w=Y.width,this.h=Y.height,this.pointValue=3,this.loaded=!1,this.img=new Image,this.img.src=n,this.img.onload=()=>{this.loaded=!0},this.spriteHeight=r,this.spriteWidth=o,this.totalFrame=a,this.currentFrame=0,this.w=64,this.h=64,this.collisionSound=new y("./sounds/obstaclecollision.m4a")}draw(t){this.loaded&&c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),t%10===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame)}moveInY(t){this.y+=t}}class di extends R{constructor(t,s,n,o,r,a){super(t,s,n,o,r,a)}changeDirection(){this.x<=u.x+u.width||this.x+this.w>=d.width?(this.dx*=-1,this.dx<0?this.img.src="./images/demon-left.png":this.img.src="./images/demon-right.png"):this.dx=this.dx}moveInX(){this.changeDirection(),this.x+=this.dx}}class z extends J{constructor(s,n,o){super(s,n);e(this,"face");this.face=o,this.w=24,this.h=24,this.selectSpike()}selectSpike(){const s=B();this.face==="right"?s?this.img.src="./images/spike1-right.png":this.img.src="./images/spike2-right.png":s?this.img.src="./images/spike1-left.png":this.img.src="./images/spike2-left.png",this.img.onload=()=>{this.loaded=!0}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}moveInY(s){this.y+=s}}class ai extends R{constructor(t,s,n,o,r,a){super(t,s,n,o,r,a)}draw(t){this.loaded&&c.drawImage(this.img,0,this.currentFrame*this.spriteHeight,this.spriteWidth,this.spriteHeight,this.x,this.y,this.w,this.h),t%10===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame)}moveInY(t){this.y+=t+1}}function M(i){let t;const s=hi(),n=O(),o=i?i.y-n-g.gapY:d.height-n-g.gapY,r=ri();return r===1?t=new W(s,o,1,"./images/normal-wall.png"):r===2?t=new W(s,o,2,"./images/rubber-wall.png"):t=new W(s,o,3,"./images/ice-wall.png"),t.h=n,t}function ci(i){const t=[];for(let s=0;s<i;++s){let n=t.length?M(t[t.length-1]):M(null);t.push(n)}return t}function li(){const i=q(),t=i+D-2*b.width>d.width-b.width?d.width-b.width:i+D,s=A(i,t);return new ni(s,0,"horizontal","./images/saw-blade.png",i,t)}function V(i){const t=d.height/2,s=[];for(let n=0;n<i;++n){const o=li(),r=d.height-o.h-t*(n+1);o.y=r,o.dx=B()?1:-1,o.dy=B()?1:-1,s.push(o)}return s}function ui(i){return new z(0,0,i)}function gi(){const i=B()?"right":"left";return ui(i)}function X(){const i=ii.height*10,t=p(3),s=[];for(let n=0;n<t;++n){let o=0;s.length&&(o=s[s.length-1].y-i);const r=new z(u.width,o,"right");r.w=32,r.h=32,r.x=r.x,s.push(r)}return s}function mi(){const i=q();return new di(i,0,"./images/demon-left.png",79,69,4)}function pi(){return[]}function fi(){let i="";switch(p(4)){case 0:i="./images/spider-black.png";break;case 1:i="./images/spider-purple.png";break;case 2:i="./images/spider-green.png";break;case 3:i="./images/spider-brown.png";break}const s=u.x+u.width-u.offSet,n=new ai(s,0,i,49,80.3,3);return n.dy=Q,n}function yi(){return[]}function wi(i){c.fillStyle="white",c.font="50px Offside",c.fillText(`${i}`,d.width/2,50)}function ki(i){if(i.walls.length){const t=i.walls[i.walls.length-1];if(t.y>d.height&&i.walls.shift(),i.walls[i.walls.length-1].y>g.gapY){const s=O(),n=i.walls[i.walls.length-1].y-g.gapY-s,o=M(t);o.h=s,o.y=n,i.walls.push(o)}}else i.walls.push(M(null))}function xi(i){if(i.blades.forEach(t=>{t.y>d.height&&i.blades.shift()}),i.blades.length===0){const t=V(p(3));t.reverse(),t.forEach(s=>{s.y*=-1}),i.blades.push(...t)}}function Ii(i){if(i.mainWallSpikes.forEach(t=>{t.y>d.height&&i.mainWallSpikes.shift()}),i.mainWallSpikes.length===0){const t=X();i.mainWallSpikes.push(...t)}}function bi(i,t){i.length&&(i[0].y>d.height&&i.shift(),i.forEach(s=>{s.moveInY(t),s.moveInX()}))}function Wi(i,t){i.length&&(i[0].y>d.height&&i.shift(),i.forEach(s=>{s.moveInY(t)}))}function vi(){let i;const t=localStorage.getItem("walljumper");return t?i=JSON.parse(t):i=[],i}function Li(i){localStorage.setItem("walljumper",JSON.stringify(i))}function Bi(i,t){let s=!1;t.forEach(n=>{n.name===i.name&&(n.value<i.value&&(n.value=i.value),s=!0)}),s||t.push(i)}const Mi=document.querySelector(".start-menu"),G=document.querySelector(".restart-menu"),_=document.querySelector(".pause-window"),Ei=document.querySelector(".score"),N=document.querySelector(".leaderboard");function Ci(i){N.innerHTML="";for(const t of i){const s=document.createElement("p"),n=document.createElement("span"),o=document.createElement("span");s.classList.add("leaderboard-row"),n.classList.add("leaderboard-entry"),o.classList.add("leaderboard-entry"),n.innerHTML=t.name,o.innerHTML=t.value.toString(),s.appendChild(n),s.appendChild(o),N.appendChild(s)}}function S(i){Mi.style.display="none",G.style.display="none",w.style.display="block";const t=setTimeout(()=>{i.clickState=!0,clearTimeout(t)},10)}function k(i,t){t.player.jumpCount=0;const s=vi(),n={name:t.userName,value:t.score};Bi(n,s),s.sort((r,a)=>a.value-r.value),Li(s),Ci(s),G.style.display="flex",Ei.innerHTML=`${t.userName} : ${t.score}`,w.style.display="none";const o=setTimeout(()=>{i.clickState=!0,clearTimeout(o)},10)}function Fi(){_.style.display="flex"}function Yi(){_.style.display="none"}class j{constructor(t,s,n){e(this,"x");e(this,"y");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"duration");this.x=t,this.y=s,this.w=32,this.h=48,this.dy=f,this.loaded=!1,this.img=new Image,this.img.src=n,this.duration=0,this.img.onload=()=>{this.loaded=!0,this.draw()}}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}setDuration(t){this.duration=t}getDuration(){return this.duration}moveInY(){this.y+=this.dy}}function Di(i,t){const s=i.x+i.w/2-(t.x+t.w/2),n=i.y+i.h/2-(t.y+t.h/2),o=(i.w+t.w)/2,r=(i.h+t.h)/2,a=o*n,m=r*s;if(Math.abs(s)<=o&&Math.abs(n)<=r)if(a>m){if(a>-m)i.y=t.y+t.h-i.h/2,i.x<t.x?i.x=t.x-i.w:i.x=t.x+t.w;else if(i.x=t.x-i.w,i.xDirection=-1,i.img.src="./images/grab-right.png",t.type===3&&!t.effectUsed){const E=new j(i.x,i.y,"./images/icecloud-right.png");t.effect=E}}else if(a>-m){if(i.x=t.x+t.w,i.xDirection=1,i.img.src="./images/grab-left.png",t.type===3&&!t.effectUsed){const E=new j(i.x,i.y,"./images/icecloud-left.png");t.effect=E}}else i.y=t.y,i.x<t.x?i.x=t.x-i.w:i.x=t.x+t.w}function P(i){i.xDirection*=-1,i.dx=i.xDirection*C,i.dy=x,i.isJumping=!0}class Ni{constructor(t,s,n){e(this,"x");e(this,"y");e(this,"dx");e(this,"dy");e(this,"w");e(this,"h");e(this,"img");e(this,"loaded");e(this,"horizontalDelay");e(this,"gravity");e(this,"isJumping");e(this,"jumpCount");e(this,"xDirection");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"currentFrame");e(this,"totalFrame");e(this,"jumpSound");e(this,"airJumpSound");e(this,"fallSound");this.x=t,this.y=s,this.w=32,this.h=32,this.xDirection=1,this.horizontalDelay=.05,this.gravity=.1,this.dx=C,this.dy=x,this.isJumping=!1,this.jumpCount=2,this.loaded=!1,this.img=new Image,this.img.src=n,this.img.onload=()=>{this.loaded=!0,this.draw()},this.spriteHeight=67,this.spriteWidth=64,this.currentFrame=0,this.totalFrame=8,this.jumpSound=new y("./sounds/jumpsound.m4a"),this.airJumpSound=new y("./sounds/airjumpsound.m4a"),this.fallSound=new y("./sounds/fallsound.m4a")}draw(){this.loaded&&c.drawImage(this.img,this.x,this.y,this.w,this.h)}drawJumpSprite(t){this.loaded&&(c.drawImage(this.img,this.currentFrame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,48,48),t%2===0&&(this.currentFrame=(this.currentFrame+1)%this.totalFrame))}resetJump(){this.jumpCount===1&&(this.xDirection*=-1),this.dx=C*this.xDirection,this.dy=x}changeJumpingImage(){this.dx>0&&this.jumpCount===1?this.img.src="./images/jump-right.png":this.dx<0&&this.jumpCount===1?this.img.src="./images/jump-left.png":this.dx>0&&this.jumpCount===0?this.img.src="./images/mid-jump-right-sprite.png":this.img.src="./images/mid-jump-left-sprite.png"}jump(){this.changeJumpingImage(),this.dy+=this.gravity,this.dx=this.dx>0?this.dx-this.horizontalDelay:this.dx+this.horizontalDelay,this.x+=this.dx,this.dy>0?this.y+=this.dy:this.y>0?this.y+=this.dy:this.y=0,this.dy>-x&&(this.dy=-x),this.x+this.w>=d.width&&P(this)}isColliding(t){return t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h/2&&t.y+t.h>this.y}collisionWall(t){this.isColliding(t)&&(this.jumpCount=2,this.isJumping=!1,t.type===2?(t.sound=new y("./sounds/rubberbounce1.mp3"),t.sound.play(),this.isJumping=!0,--this.jumpCount,P(this)):t.type===3&&(t.sound=new y("./sounds/freezingSound.m4a"),t.sound.play())),Di(this,t)}moveInY(t){this.y+=t}}class F{constructor(t,s,n,o,r,a,m){e(this,"x");e(this,"y");e(this,"dy");e(this,"skyLoaded");e(this,"skyImg");e(this,"rockBackgroundLoaded");e(this,"rockBackgroundImg");e(this,"rockLoaded");e(this,"rockImg");e(this,"cloudBackgroundLoaded");e(this,"cloudBackgroundImg");e(this,"cloudLoaded");e(this,"cloudImg");this.x=t,this.y=s,this.dy=f,this.skyImg=new Image,this.skyImg.src=n,this.skyLoaded=!1,this.skyImg.onload=()=>{this.skyLoaded=!0,this.draw()},this.rockBackgroundImg=new Image,this.rockBackgroundImg.src=o,this.rockBackgroundLoaded=!1,this.rockBackgroundImg.onload=()=>{this.rockBackgroundLoaded=!0,this.draw()},this.rockImg=new Image,this.rockImg.src=r,this.rockLoaded=!1,this.rockImg.onload=()=>{this.rockLoaded=!0,this.draw()},this.cloudBackgroundImg=new Image,this.cloudBackgroundImg.src=a,this.cloudBackgroundLoaded=!1,this.cloudBackgroundImg.onload=()=>{this.cloudBackgroundLoaded=!0,this.draw()},this.cloudImg=new Image,this.cloudImg.src=m,this.cloudLoaded=!1,this.cloudImg.onload=()=>{this.cloudLoaded=!0,this.draw()}}draw(){this.skyLoaded&&this.rockBackgroundLoaded&&this.cloudBackgroundLoaded&&this.cloudLoaded&&(c.drawImage(this.skyImg,this.x,this.y),c.drawImage(this.rockBackgroundImg,this.x,this.y),c.drawImage(this.rockImg,this.x,this.y),c.drawImage(this.cloudBackgroundImg,this.x,this.y),c.drawImage(this.cloudImg,this.x,this.y))}moveInY(){this.y+=this.dy}}const Si=new F(-700,0,"./images/background/sky1.png","./images/background/rockBackground1.png","./images/background/rock1.png","./images/background/cloudbackground1.png","./images/background/cloud1.png"),ji=new F(-700,0,"./images/background/sky2.png","./images/background/rock2.png","./images/background/ground1.png","./images/background/ground2.png","./images/background/cloud2.png"),Pi=new F(-700,0,"./images/background/sky3.png","./images/background/rockbackground3.png","./images/background/rock3.png","./images/background/pines.png","./images/background/cloud3.png"),Ti=document.querySelector(".btn--start"),Hi=document.querySelector(".btn--restart"),T=document.querySelector(".user-name");let I;T.onchange=()=>{I=T.value};const h={pause:!1,clickState:!1,restart:!1,gameMovement:f},U=()=>({blades:V(2),mainWall:new W(u.x,u.y,0,"./images/main-platform.png"),walls:ci(3),player:new Ni(ti,si,"./images/grab-left.png"),gameSpeed:0,demons:pi(),spiders:yi(),mainWallSpikes:X(),score:0,userName:"Unknown",backgrounds:[Si,Pi,ji]});let l=U();function v(i){c.clearRect(0,0,d.width,d.height),i.score<=20?i.backgrounds[0].draw():i.score<=40?i.backgrounds[1].draw():i.backgrounds[2].draw(),wi(i.score),++i.gameSpeed,h.gameMovement=f+i.score/10*.5,i.mainWall.draw(),i.gameSpeed%500===0&&L()&&i.demons.push(mi()),bi(i.demons,h.gameMovement);for(let t=0;t<i.demons.length&&!h.restart;++t){const s=i.demons[t];if(s.draw(i.gameSpeed),i.player.isColliding(s)){h.restart=!0,s.collisionSound.play(),k(h,i);return}}i.gameSpeed%300===0&&L()&&i.spiders.push(fi()),Wi(i.spiders,h.gameMovement);for(let t=0;t<i.spiders.length&&!h.restart;++t){const s=i.spiders[t];if(s.draw(i.gameSpeed),i.player.isColliding(s)){h.restart=!0,s.collisionSound.play(),k(h,i);return}}for(let t=0;t<i.mainWallSpikes.length&&!h.restart;++t){const s=i.mainWallSpikes[t];if(s.moveInY(h.gameMovement),s.draw(),i.player.isColliding(s)){h.restart=!0,s.collisionSound.play(),k(h,i);return}}if(i.player.moveInY(h.gameMovement),i.player.y>d.height){h.restart=!0,i.player.fallSound.play(),k(h,i);return}i.player.collisionWall(i.mainWall),i.player.jumpCount?i.player.draw():i.player.drawJumpSprite(i.gameSpeed),i.player.isJumping&&i.player.jump();for(let t=0;t<i.walls.length&&!h.restart;++t){const s=i.walls[t];if(s.moveInY(h.gameMovement),s.draw(),s.effect&&!s.effectUsed){s.effect.draw(),h.clickState=!1;const n=setTimeout(()=>{s.effect=null,s.effectUsed=!0,h.clickState=!0,clearTimeout(n)},1e3)}if(s.spike&&(s.spike.draw(),i.player.isColliding(s.spike))){h.restart=!0,s.spike.collisionSound.play(),k(h,i);return}i.player.collisionWall(s)}for(let t=0;t<i.blades.length;++t){const s=i.blades[t];if(s.moveInY(h.gameMovement),s.draw(),s.oscillate(),i.player.isColliding(s)){h.restart=!0,s.collisionSound.play(),k(h,i);return}}xi(i),ki(i),Ii(i),i.gameSpeed%100===0&&++i.score,!h.pause&&requestAnimationFrame(()=>v(i))}function Ji(){Ti.onclick=()=>{I&&(l.userName=I),h.clickState=!1,S(h),l.mainWall.setMainWall(),v(l)},Hi.onclick=()=>{h.clickState=!1,h.restart=!1,h.gameMovement=f,S(h),l=U(),I&&(l.userName=I),l.mainWall.setMainWall(),v(l)},document.addEventListener("click",()=>{!h.pause&&h.clickState&&(c.clearRect(0,0,d.width,d.height),l.player.jumpCount>0&&(l.player.isJumping=!0,l.player.jumpCount===2?l.player.jumpSound.play():l.player.airJumpSound.play(),l.player.resetJump(),--l.player.jumpCount))}),document.addEventListener("keydown",i=>{i.key===" "&&h.pause?(h.pause=!1,Yi(),v(l)):i.key===" "&&!h.restart&&(h.pause=!0,Fi())})}Ji();
